define(["exports","./arrayFill-0358accf","./buildModuleUrl-497c1c9b","./Cartographic-67e73ef9","./ComponentDatatype-81047f82","./when-92c6cf3c","./Check-52a7d806","./EllipseGeometryLibrary-849e3824","./Rectangle-bab7abf0","./GeometryAttribute-a866ebdb","./GeometryAttributes-7f66ea53","./GeometryOffsetAttribute-b4d599f5","./IndexDatatype-4c0e98b8","./Math-92c3b5f7","./PrimitiveType-a380809f"],(function(e,t,i,r,n,a,o,s,u,l,d,c,h,p,f){"use strict";var m=new r.t,_=new r.t;var b=new i.i,A=new i.i;function g(e){var t=(e=a.u(e,a.u.EMPTY_OBJECT)).center,i=a.u(e.ellipsoid,u.t.WGS84),n=e.semiMajorAxis,s=e.semiMinorAxis,l=a.u(e.granularity,p.e.RADIANS_PER_DEGREE);if(!a.e(t))throw new o.t("center is required.");if(!a.e(n))throw new o.t("semiMajorAxis is required.");if(!a.e(s))throw new o.t("semiMinorAxis is required.");if(n<s)throw new o.t("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(l<=0)throw new o.t("granularity must be greater than zero.");var d=a.u(e.height,0),c=a.u(e.extrudedHeight,d);this._center=r.t.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=s,this._ellipsoid=u.t.clone(i),this._rotation=a.u(e.rotation,0),this._height=Math.max(c,d),this._granularity=l,this._extrudedHeight=Math.min(c,d),this._numberOfVerticalLines=Math.max(a.u(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._outlineWidth=a.u(e.outlineWidth,1),this._workerName="createEllipseOutlineGeometry"}g.packedLength=r.t.packedLength+u.t.packedLength+9,g.pack=function(e,t,i){if(!a.e(e))throw new o.t("value is required");if(!a.e(t))throw new o.t("array is required");return i=a.u(i,0),r.t.pack(e._center,t,i),i+=r.t.packedLength,u.t.pack(e._ellipsoid,t,i),i+=u.t.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._numberOfVerticalLines,t[i++]=a.u(e._offsetAttribute,-1),t[i]=e._outlineWidth,t};var y=new r.t,v=new u.t,x={center:y,ellipsoid:v,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0,outlineWidth:void 0};g.unpack=function(e,t,i){if(!a.e(e))throw new o.t("array is required");t=a.u(t,0);var n=r.t.unpack(e,t,y);t+=r.t.packedLength;var s=u.t.unpack(e,t,v);t+=u.t.packedLength;var l=e[t++],d=e[t++],c=e[t++],h=e[t++],p=e[t++],f=e[t++],m=e[t++],_=e[t++],b=e[t];return a.e(i)?(i._center=r.t.clone(n,i._center),i._ellipsoid=u.t.clone(s,i._ellipsoid),i._semiMajorAxis=l,i._semiMinorAxis=d,i._rotation=c,i._height=h,i._granularity=p,i._extrudedHeight=f,i._numberOfVerticalLines=m,i._offsetAttribute=-1===_?void 0:_,i._outlineWidth=b,i):(x.height=h,x.extrudedHeight=f,x.granularity=p,x.rotation=c,x.semiMajorAxis=l,x.semiMinorAxis=d,x.numberOfVerticalLines=m,x.offsetAttribute=-1===_?void 0:_,x.outlineWidth=b,new g(x))},g.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){var o=e._height,u=e._extrudedHeight,g=!p.e.equalsEpsilon(o,u,0,p.e.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var y,v={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:o,granularity:e._granularity,outlineWidth:e._outlineWidth,numberOfVerticalLines:e._numberOfVerticalLines};if(g)v.extrudedHeight=u,v.offsetAttribute=e._offsetAttribute,y=function(e){var o=e.center,u=e.ellipsoid,f=e.semiMajorAxis,_=r.t.multiplyByScalar(u.geodeticSurfaceNormal(o,m),e.height,m);b.center=r.t.add(o,_,b.center),b.radius=f,_=r.t.multiplyByScalar(u.geodeticSurfaceNormal(o,_),e.extrudedHeight,_),A.center=r.t.add(o,_,A.center),A.radius=f;var g=s.C.computeEllipsePositions(e,!1,!0).outerPositions,y=new d.a({position:new l.o({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:s.C.raisePositionsToHeight(g,e,!0)})});g=y.position.values;var v=i.i.union(b,A),x=g.length/3;if(a.e(e.offsetAttribute)){var w=new Uint8Array(x);if(e.offsetAttribute===c.z.TOP)w=t.d(w,1,0,x/2);else{var M=e.offsetAttribute===c.z.NONE?0:1;w=t.d(w,M)}y.applyOffset=new l.o({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}var L=a.u(e.numberOfVerticalLines,16);L=p.e.clamp(L,0,x/2);var E=h.IndexDatatype.createTypedArray(x,2*x+2*L);x/=2;var O,D,S=0;for(O=0;O<x;++O)E[S++]=O,E[S++]=(O+1)%x,E[S++]=O+x,E[S++]=(O+1)%x+x;if(L>0){var P=Math.min(L,x);D=Math.round(x/P);var k=Math.min(D*L,x);for(O=0;O<k;O+=D)E[S++]=O,E[S++]=O+x}return{boundingSphere:v,attributes:y,indices:E}}(v);else if(y=function(e){var t=e.center;_=r.t.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,_),e.height,_),_=r.t.add(t,_,_);var a=new i.i(_,e.semiMajorAxis),o=s.C.computeEllipsePositions(e,!1,!0).outerPositions;o.push(o[0],o[1],o[2]);var u=new d.a({position:new l.o({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:s.C.raisePositionsToHeight(o,e,!1)})});u.sideness=new l.o({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array([0,0,0,1,1,1,1,0])}),u.sideness.isInstanceAttribute=!0;for(var c=o.length/3,p=h.IndexDatatype.createTypedArray(c,2*c),f=0,m=0;m<c;++m)p[f++]=m,p[f++]=(m+1)%c;return{boundingSphere:a,attributes:u,indices:p}}(v),a.e(e._offsetAttribute)){var x=y.attributes.position.values.length,w=new Uint8Array(x/3),M=e._offsetAttribute===c.z.NONE?0:1;t.d(w,M),y.attributes.applyOffset=new l.o({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:w})}return new l.I({attributes:y.attributes,indices:y.indices,primitiveType:f._0x5d95ba.TRIANGLES,boundingSphere:y.boundingSphere,offsetAttribute:e._offsetAttribute})}},e.M=g}));
