define(["./when-92c6cf3c","./Rectangle-bab7abf0","./ArcType-31298545","./arrayRemoveDuplicates-f7eaafa2","./buildModuleUrl-497c1c9b","./Cartographic-67e73ef9","./Color-45274500","./ComponentDatatype-81047f82","./Check-52a7d806","./GeometryAttribute-a866ebdb","./GeometryAttributes-7f66ea53","./IndexDatatype-4c0e98b8","./Math-92c3b5f7","./PolylinePipeline-7f6d97e4","./PrimitiveType-a380809f","./VertexFormat-f496a3f1","./Intersect-b97e930a","./Event-3390cd7d","./RuntimeError-c6a62a80","./FeatureDetection-067cb23c","./WebGLConstants-71f10989","./Cartesian2-6033fa5d","./Cartesian4-ad128b5d","./EllipsoidGeodesic-04ac0e77","./EllipsoidRhumbLine-8847d1a1","./IntersectionTests-9f0b9a05","./Plane-2ee48c55"],(function(e,t,r,a,o,n,i,l,s,c,p,d,u,h,f,y,m,v,w,_,g,b,L,D,E,A,P){"use strict";var x=[];function k(e,t,r,a,o){var n=x;n.length=o;var l,s=r.red,c=r.green,p=r.blue,d=r.alpha,u=a.red,h=a.green,f=a.blue,y=a.alpha;if(i.e.equals(r,a)){for(l=0;l<o;l++)n[l]=i.e.clone(r);return n}var m=(u-s)/o,v=(h-c)/o,w=(f-p)/o,_=(y-d)/o;for(l=0;l<o;l++)n[l]=new i.e(s+l*m,c+l*v,p+l*w,d+l*_);return n}function T(a){var l=(a=e.u(a,e.u.EMPTY_OBJECT)).positions,c=a.colors,p=e.u(a.width,1),d=e.u(a.hMax,-1),h=e.u(a.colorsPerVertex,!1);if(!e.e(l)||l.length<2)throw new s.t("At least two positions are required.");if("number"!=typeof p)throw new s.t("width must be a number");if(e.e(c)&&(h&&c.length<l.length||!h&&c.length<l.length-1))throw new s.t("colors has an invalid length.");this._positions=l,this._colors=c,this._width=p,this._hMax=d,this._colorsPerVertex=h,this._dist=a.dist,this._period=a.period,this._vertexFormat=y.n.clone(e.u(a.vertexFormat,y.n.DEFAULT)),this._followSurface=e.u(a.followSurface,!0),e.e(a.followSurface)&&(function(t,r){if(!e.e(t)||!e.e(r))throw new s.t("identifier and message are required.");o.e(t,r)}("PolylineGeometry.followSurface","PolylineGeometry.followSurface is deprecated and will be removed in Cesium 1.55. Use PolylineGeometry.arcType instead."),a.arcType=a.followSurface?r.L.GEODESIC:r.L.NONE),this._arcType=e.u(a.arcType,r.L.GEODESIC),this._followSurface=this._arcType!==r.L.NONE,this._granularity=e.u(a.granularity,u.e.RADIANS_PER_DEGREE),this._ellipsoid=t.t.clone(e.u(a.ellipsoid,t.t.WGS84)),this._workerName="createPolylineGeometry";var f=1+l.length*n.t.packedLength;f+=e.e(c)?1+c.length*i.e.packedLength:1,this.packedLength=f+t.t.packedLength+y.n.packedLength+4+2}T.pack=function(r,a,o){if(!e.e(r))throw new s.t("value is required");if(!e.e(a))throw new s.t("array is required");o=e.u(o,0);var l,c=r._positions,p=c.length;for(a[o++]=p,l=0;l<p;++l,o+=n.t.packedLength)n.t.pack(c[l],a,o);var d=r._colors;for(p=e.e(d)?d.length:0,a[o++]=p,l=0;l<p;++l,o+=i.e.packedLength)i.e.pack(d[l],a,o);return t.t.pack(r._ellipsoid,a,o),o+=t.t.packedLength,y.n.pack(r._vertexFormat,a,o),o+=y.n.packedLength,a[o++]=r._width,a[o++]=r._colorsPerVertex?1:0,a[o++]=r._arcType,a[o++]=r._granularity,a[o++]=r._hMax,a[o++]=r._dist,a[o]=r._period,a};var C=t.t.clone(t.t.UNIT_SPHERE),F=new y.n,G={positions:void 0,colors:void 0,ellipsoid:C,vertexFormat:F,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};T.unpack=function(r,a,o){if(!e.e(r))throw new s.t("array is required");a=e.u(a,0);var l,c=r[a++],p=new Array(c);for(l=0;l<c;++l,a+=n.t.packedLength)p[l]=n.t.unpack(r,a);var d=(c=r[a++])>0?new Array(c):void 0;for(l=0;l<c;++l,a+=i.e.packedLength)d[l]=i.e.unpack(r,a);var u=t.t.unpack(r,a,C);a+=t.t.packedLength;var h=y.n.unpack(r,a,F);a+=y.n.packedLength;var f=r[a++],m=1===r[a++],v=r[a++],w=r[a++],_=r[a++],g=1==r[a++],b=r[a];return e.e(o)?(o._positions=p,o._colors=d,o._ellipsoid=t.t.clone(u,o._ellipsoid),o._vertexFormat=y.n.clone(h,o._vertexFormat),o._width=f,o._colorsPerVertex=m,o._arcType=v,o._granularity=w,o._hMax=_,o._dist=g,o._period=b,o):(G.positions=p,G.colors=d,G.width=f,G.colorsPerVertex=m,G.arcType=v,G.granularity=w,G.hMax=_,G.dist=g,G.period=b,new T(G))};var S=new n.t,O=new n.t,I=new n.t,M=new n.t;return T.createGeometry=function(t){var s,y,m,v=t._width,w=t._hMax,_=t._vertexFormat,g=t._colors,b=t._colorsPerVertex,L=t._arcType,D=t._granularity,E=t._ellipsoid,A=t._dist,P=t._period,T=a.D(t._positions,n.t.equalsEpsilon),C=T.length;if(!(C<2||v<=0)){if(L===r.L.GEODESIC||L===r.L.RHUMB){var F,G;L===r.L.GEODESIC?(F=u.e.chordLength(D,E.maximumRadius),G=h.m.numberOfPoints):(F=D,G=h.m.numberOfPointsRhumbLine);var R=h.m.extractHeights(T,E);if(e.e(g)){var N=1;for(s=0;s<C-1;++s)N+=G(T[s],T[s+1],F);var B=new Array(N),U=0;for(s=0;s<C-1;++s){var V=T[s],q=T[s+1],H=g[s],W=G(V,q,F);if(b&&s<N){var Y=k(0,0,H,g[s+1],W),z=Y.length;for(y=0;y<z;++y)B[U++]=Y[y]}else for(y=0;y<W;++y)B[U++]=i.e.clone(H)}B[U]=i.e.clone(g[g.length-1]),g=B,x.length=0}T=L===r.L.GEODESIC?h.m.generateCartesianArc({positions:T,minDistance:F,ellipsoid:E,height:R,hMax:w}):h.m.generateCartesianRhumbArc({positions:T,granularity:F,ellipsoid:E,height:R})}var J,j=4*(C=T.length)-4,K=new Float64Array(3*j),Q=new Float64Array(3*j),X=new Float64Array(3*j),Z=new Float32Array(2*j),$=_.st?new Float32Array(2*j):void 0,ee=e.e(g)?new Uint8Array(4*j):void 0,te=A?new Float32Array(3*j):void 0,re=0,ae=0,oe=0,ne=0,ie=0,le=0;for(y=0;y<C;++y){var se,ce;0===y?(J=S,n.t.subtract(T[0],T[1],J),n.t.add(T[0],J,J)):J=T[y-1],n.t.clone(J,I),n.t.clone(T[y],O),y===C-1?(J=S,n.t.subtract(T[C-1],T[C-2],J),n.t.add(T[C-1],J,J)):J=T[y+1],n.t.clone(J,M),e.e(ee)&&(se=0===y||b?g[y]:g[y-1],y!==C-1&&(ce=g[y]));var pe=y===C-1?2:4;for(m=0===y?2:0;m<pe;++m){n.t.pack(O,K,re),n.t.pack(I,Q,re),n.t.pack(M,X,re),re+=3;var de=m-2<0?-1:1,ue=m%2*2-1,he=ue*y/C;if(Z[ae++]=w>0?he:ue,Z[ae++]=de*v,_.st&&($[oe++]=y/(C-1),$[oe++]=Math.max(Z[ae-2],0)),e.e(ee)){var fe=m<2?se:ce;ee[ne++]=i.e.floatToByte(fe.red),ee[ne++]=i.e.floatToByte(fe.green),ee[ne++]=i.e.floatToByte(fe.blue),ee[ne++]=i.e.floatToByte(fe.alpha)}A&&(te[3*ie]=le,ie++)}le+=n.t.distance(J,T[y])}if(A){var ye=le,me=Math.random()*(P>0?P:ye);for(y=0;y<j;y++)te[3*y+1]=ye,te[3*y+2]=me}var ve=new p.a;ve.position=new c.o({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:K}),ve.prevPosition=new c.o({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:Q}),ve.nextPosition=new c.o({componentDatatype:l.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:X}),ve.expandAndWidth=new c.o({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:Z}),_.st&&(ve.st=new c.o({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:$})),e.e(ee)&&(ve.color=new c.o({componentDatatype:l.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:4,values:ee,normalize:!0})),A&&(ve.dist=new c.o({componentDatatype:l.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:te}));var we=d.IndexDatatype.createTypedArray(j,6*C-6),_e=0,ge=0,be=C-1;for(y=0;y<be;++y)we[ge++]=_e,we[ge++]=_e+2,we[ge++]=_e+1,we[ge++]=_e+1,we[ge++]=_e+2,we[ge++]=_e+3,_e+=4;return new c.I({attributes:ve,indices:we,primitiveType:f._0x5d95ba.TRIANGLES,boundingSphere:o.i.fromPoints(T),geometryType:c.Me.POLYLINES})}},function(r,a){return e.e(a)&&(r=T.unpack(r,a)),r._ellipsoid=t.t.clone(r._ellipsoid),T.createGeometry(r)}}));
